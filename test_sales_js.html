<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Sales JavaScript</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-2xl font-bold mb-6">Test Sales JavaScript</h1>
        
        <div class="bg-white p-6 rounded-lg shadow mb-6">
            <h2 class="text-lg font-semibold mb-4">Medicine Search Test</h2>
            
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">Add Medicine</label>
                <div class="flex space-x-2">
                    <input type="text" id="medicineSearch" placeholder="Search medicine by name or barcode..."
                           class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                    <button type="button" onclick="searchMedicine()" 
                            class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md transition duration-200">
                        <i class="fas fa-search"></i> Search
                    </button>
                </div>
                <div id="medicineResults" class="mt-2 max-h-40 overflow-y-auto border border-gray-200 rounded-md hidden"></div>
            </div>
        </div>
        
        <div class="bg-white p-6 rounded-lg shadow mb-6">
            <h2 class="text-lg font-semibold mb-4">Cart</h2>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200" id="cartTable">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Medicine</th>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Price</th>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Qty</th>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Total</th>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Action</th>
                        </tr>
                    </thead>
                    <tbody id="cartItems" class="bg-white divide-y divide-gray-200">
                        <tr id="emptyCart">
                            <td colspan="5" class="px-4 py-8 text-center text-gray-500">No items in cart</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="bg-white p-6 rounded-lg shadow">
            <h2 class="text-lg font-semibold mb-4">Debug Console</h2>
            <div id="debugConsole" class="bg-gray-100 p-4 rounded text-sm font-mono h-40 overflow-y-auto"></div>
            <button onclick="clearDebug()" class="mt-2 bg-red-600 text-white px-3 py-1 rounded text-sm">Clear</button>
        </div>
    </div>

    <script>
        // Override console.log to show in our debug console
        const originalLog = console.log;
        const originalError = console.error;
        
        function addToDebug(message, type = 'log') {
            const debugDiv = document.getElementById('debugConsole');
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? 'text-red-600' : 'text-gray-800';
            debugDiv.innerHTML += `<div class="${color}">[${timestamp}] ${message}</div>`;
            debugDiv.scrollTop = debugDiv.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addToDebug(args.join(' '), 'log');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addToDebug(args.join(' '), 'error');
        };
        
        function clearDebug() {
            document.getElementById('debugConsole').innerHTML = '';
        }
        
        // Test if the sales.js functions are available
        console.log('Testing sales.js functions...');
        
        if (typeof searchMedicine === 'function') {
            console.log('✅ searchMedicine function is available');
        } else {
            console.error('❌ searchMedicine function is NOT available');
        }
        
        if (typeof addToCart === 'function') {
            console.log('✅ addToCart function is available');
        } else {
            console.error('❌ addToCart function is NOT available');
        }
        
        // Test manual search
        function testManualSearch() {
            console.log('Testing manual search...');
            
            fetch('api/search_medicines.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ query: 'para' })
            })
            .then(response => {
                console.log('Response status:', response.status);
                return response.json();
            })
            .then(data => {
                console.log('Manual search response:', data);
            })
            .catch(error => {
                console.error('Manual search error:', error);
            });
        }
        
        // Add test button
        setTimeout(() => {
            const testBtn = document.createElement('button');
            testBtn.textContent = 'Test Manual Search';
            testBtn.className = 'bg-green-600 text-white px-4 py-2 rounded ml-2';
            testBtn.onclick = testManualSearch;
            document.querySelector('.flex.space-x-2').appendChild(testBtn);
        }, 100);
    </script>
    
    <!-- Load the sales.js file -->
    <script src="assets/js/sales.js"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</body>
</html>